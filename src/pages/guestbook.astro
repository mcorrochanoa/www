---
import GuestCard from '@components/ui/GuestCard.astro'
import GuestForm from '@components/ui/GuestForm.astro'
import Layout from '@layouts/Layout.astro'
import { db, desc, Guestbook as GuestbookDB } from 'astro:db'

export const prerender = false
const notes = await db
  .select()
  .from(GuestbookDB)
  .orderBy(desc(GuestbookDB.date))
  .all()
---

<Layout title="Guestbook - Leave a note for the history!">
  <div class="flex flex-col max-sm:text-center">
    <h3 class="text-4xl font-semibold">Guestbook</h3>
    <p>{notes.length} people have left messages!</p>
  </div>
  <ul class="grid grid-cols-2 gap-10 max-sm:grid-cols-1">
    <GuestForm />
    {notes.map((note) => <GuestCard {note} />)}
  </ul>
</Layout>
